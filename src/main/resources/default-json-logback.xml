<included>
  <jmxConfigurator/>

  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder class="net.logstash.logback.encoder.LogstashEncoder">
      <fieldNames>
        <message>[ignore]</message>
      </fieldNames>
      <provider class="net.logstash.logback.composite.loggingevent.LoggingEventPatternJsonProvider">
        <pattern>
          {
            "message": "%replace(%msg){'secret:::[a-zA-Z0-9=_-]+', '[secret]'}"
          }
        </pattern>
      </provider>
      <throwableConverter class="net.logstash.logback.stacktrace.ShortenedThrowableConverter">
        <maxDepthPerThrowable>30</maxDepthPerThrowable>
        <maxLength>2048</maxLength>
        <exclude>akka\.*</exclude>
        <exclude>scala\.*</exclude>
        <exclude>java\.*</exclude>
      </throwableConverter>
    </encoder>
  </appender>

  <appender name="METRICS" class="io.prometheus.client.logback.InstrumentedAppender"/>

  <logger name="org.jboss.netty" level="INFO"/>
  <logger name="reactor.ipc.netty" level="INFO"/>
  <logger name="org.asynchttpclient" level="INFO"/>
  <logger name="com.ning.http.client" level="INFO"/>
  <logger name="org.springframework" level="INFO"/>
  <logger name="org.apache" level="INFO"/>
  <logger name="org.apache.coyote.http11.Http11InputBuffer" level="DEBUG"/>
  <logger name="org.hibernate" level="WARN"/>
  <logger name="javax.management" level="INFO"/>
  <logger name="io.netty" level="INFO"/>
  <logger name="org.postgresql" level="INFO"/>
  <logger name="org.flywaydb" level="INFO"/>
  <logger name="sun.rmi" level="WARN"/>
  <logger name="com.zaxxer.hikari" level="INFO"/>
  <logger name="springfox.documentation" level="INFO"/>

  <root level="TRACE">
    <appender-ref ref="STDOUT"/>
    <appender-ref ref="METRICS"/>
  </root>
</included>
